-- House Sales Forecasting 튜토리얼용 데이터베이스 설정
-- https://docs.mindsdb.com/use-cases/predictive_analytics/house-sales-forecasting

-- 데이터베이스 생성 (이미 있으면 무시)
-- CREATE DATABASE demo_data;

-- house_sales 테이블 생성
DROP TABLE IF EXISTS house_sales;

CREATE TABLE house_sales (
    id SERIAL PRIMARY KEY,
    saledate DATE NOT NULL,
    ma DECIMAL(10, 2) NOT NULL,  -- Moving Average of median price
    type VARCHAR(20) NOT NULL,   -- 'house' or 'unit'
    bedrooms INTEGER NOT NULL,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- 샘플 데이터 삽입 (호주 주택 판매 데이터 시뮬레이션)
-- 2020년부터 2024년까지 분기별 데이터

-- House 타입, 1 bedroom
INSERT INTO house_sales (saledate, ma, type, bedrooms) VALUES
('2020-03-31', 450000.00, 'house', 1),
('2020-06-30', 455000.00, 'house', 1),
('2020-09-30', 462000.00, 'house', 1),
('2020-12-31', 470000.00, 'house', 1),
('2021-03-31', 485000.00, 'house', 1),
('2021-06-30', 495000.00, 'house', 1),
('2021-09-30', 510000.00, 'house', 1),
('2021-12-31', 525000.00, 'house', 1),
('2022-03-31', 540000.00, 'house', 1),
('2022-06-30', 535000.00, 'house', 1),
('2022-09-30', 528000.00, 'house', 1),
('2022-12-31', 520000.00, 'house', 1),
('2023-03-31', 515000.00, 'house', 1),
('2023-06-30', 522000.00, 'house', 1),
('2023-09-30', 530000.00, 'house', 1),
('2023-12-31', 538000.00, 'house', 1),
('2024-03-31', 545000.00, 'house', 1),
('2024-06-30', 552000.00, 'house', 1),
('2024-09-30', 558000.00, 'house', 1),
('2024-12-31', 565000.00, 'house', 1);

-- House 타입, 2 bedroom
INSERT INTO house_sales (saledate, ma, type, bedrooms) VALUES
('2020-03-31', 550000.00, 'house', 2),
('2020-06-30', 558000.00, 'house', 2),
('2020-09-30', 568000.00, 'house', 2),
('2020-12-31', 580000.00, 'house', 2),
('2021-03-31', 600000.00, 'house', 2),
('2021-06-30', 620000.00, 'house', 2),
('2021-09-30', 645000.00, 'house', 2),
('2021-12-31', 670000.00, 'house', 2),
('2022-03-31', 695000.00, 'house', 2),
('2022-06-30', 685000.00, 'house', 2),
('2022-09-30', 672000.00, 'house', 2),
('2022-12-31', 660000.00, 'house', 2),
('2023-03-31', 655000.00, 'house', 2),
('2023-06-30', 665000.00, 'house', 2),
('2023-09-30', 678000.00, 'house', 2),
('2023-12-31', 690000.00, 'house', 2),
('2024-03-31', 702000.00, 'house', 2),
('2024-06-30', 715000.00, 'house', 2),
('2024-09-30', 725000.00, 'house', 2),
('2024-12-31', 738000.00, 'house', 2);

-- House 타입, 3 bedroom
INSERT INTO house_sales (saledate, ma, type, bedrooms) VALUES
('2020-03-31', 680000.00, 'house', 3),
('2020-06-30', 692000.00, 'house', 3),
('2020-09-30', 708000.00, 'house', 3),
('2020-12-31', 725000.00, 'house', 3),
('2021-03-31', 755000.00, 'house', 3),
('2021-06-30', 785000.00, 'house', 3),
('2021-09-30', 820000.00, 'house', 3),
('2021-12-31', 855000.00, 'house', 3),
('2022-03-31', 890000.00, 'house', 3),
('2022-06-30', 875000.00, 'house', 3),
('2022-09-30', 858000.00, 'house', 3),
('2022-12-31', 842000.00, 'house', 3),
('2023-03-31', 835000.00, 'house', 3),
('2023-06-30', 848000.00, 'house', 3),
('2023-09-30', 865000.00, 'house', 3),
('2023-12-31', 882000.00, 'house', 3),
('2024-03-31', 898000.00, 'house', 3),
('2024-06-30', 915000.00, 'house', 3),
('2024-09-30', 928000.00, 'house', 3),
('2024-12-31', 945000.00, 'house', 3);

-- House 타입, 4 bedroom
INSERT INTO house_sales (saledate, ma, type, bedrooms) VALUES
('2020-03-31', 850000.00, 'house', 4),
('2020-06-30', 865000.00, 'house', 4),
('2020-09-30', 885000.00, 'house', 4),
('2020-12-31', 910000.00, 'house', 4),
('2021-03-31', 950000.00, 'house', 4),
('2021-06-30', 995000.00, 'house', 4),
('2021-09-30', 1045000.00, 'house', 4),
('2021-12-31', 1100000.00, 'house', 4),
('2022-03-31', 1150000.00, 'house', 4),
('2022-06-30', 1125000.00, 'house', 4),
('2022-09-30', 1095000.00, 'house', 4),
('2022-12-31', 1070000.00, 'house', 4),
('2023-03-31', 1058000.00, 'house', 4),
('2023-06-30', 1078000.00, 'house', 4),
('2023-09-30', 1102000.00, 'house', 4),
('2023-12-31', 1128000.00, 'house', 4),
('2024-03-31', 1152000.00, 'house', 4),
('2024-06-30', 1178000.00, 'house', 4),
('2024-09-30', 1198000.00, 'house', 4),
('2024-12-31', 1225000.00, 'house', 4);

-- Unit 타입, 1 bedroom
INSERT INTO house_sales (saledate, ma, type, bedrooms) VALUES
('2020-03-31', 320000.00, 'unit', 1),
('2020-06-30', 325000.00, 'unit', 1),
('2020-09-30', 332000.00, 'unit', 1),
('2020-12-31', 340000.00, 'unit', 1),
('2021-03-31', 355000.00, 'unit', 1),
('2021-06-30', 368000.00, 'unit', 1),
('2021-09-30', 382000.00, 'unit', 1),
('2021-12-31', 398000.00, 'unit', 1),
('2022-03-31', 412000.00, 'unit', 1),
('2022-06-30', 405000.00, 'unit', 1),
('2022-09-30', 395000.00, 'unit', 1),
('2022-12-31', 388000.00, 'unit', 1),
('2023-03-31', 385000.00, 'unit', 1),
('2023-06-30', 392000.00, 'unit', 1),
('2023-09-30', 402000.00, 'unit', 1),
('2023-12-31', 412000.00, 'unit', 1),
('2024-03-31', 420000.00, 'unit', 1),
('2024-06-30', 428000.00, 'unit', 1),
('2024-09-30', 435000.00, 'unit', 1),
('2024-12-31', 445000.00, 'unit', 1);

-- Unit 타입, 2 bedroom
INSERT INTO house_sales (saledate, ma, type, bedrooms) VALUES
('2020-03-31', 420000.00, 'unit', 2),
('2020-06-30', 428000.00, 'unit', 2),
('2020-09-30', 438000.00, 'unit', 2),
('2020-12-31', 450000.00, 'unit', 2),
('2021-03-31', 470000.00, 'unit', 2),
('2021-06-30', 490000.00, 'unit', 2),
('2021-09-30', 512000.00, 'unit', 2),
('2021-12-31', 535000.00, 'unit', 2),
('2022-03-31', 555000.00, 'unit', 2),
('2022-06-30', 545000.00, 'unit', 2),
('2022-09-30', 532000.00, 'unit', 2),
('2022-12-31', 520000.00, 'unit', 2),
('2023-03-31', 515000.00, 'unit', 2),
('2023-06-30', 525000.00, 'unit', 2),
('2023-09-30', 538000.00, 'unit', 2),
('2023-12-31', 552000.00, 'unit', 2),
('2024-03-31', 565000.00, 'unit', 2),
('2024-06-30', 578000.00, 'unit', 2),
('2024-09-30', 588000.00, 'unit', 2),
('2024-12-31', 602000.00, 'unit', 2);

-- Unit 타입, 3 bedroom
INSERT INTO house_sales (saledate, ma, type, bedrooms) VALUES
('2020-03-31', 520000.00, 'unit', 3),
('2020-06-30', 530000.00, 'unit', 3),
('2020-09-30', 542000.00, 'unit', 3),
('2020-12-31', 558000.00, 'unit', 3),
('2021-03-31', 582000.00, 'unit', 3),
('2021-06-30', 608000.00, 'unit', 3),
('2021-09-30', 638000.00, 'unit', 3),
('2021-12-31', 668000.00, 'unit', 3),
('2022-03-31', 695000.00, 'unit', 3),
('2022-06-30', 682000.00, 'unit', 3),
('2022-09-30', 665000.00, 'unit', 3),
('2022-12-31', 650000.00, 'unit', 3),
('2023-03-31', 642000.00, 'unit', 3),
('2023-06-30', 655000.00, 'unit', 3),
('2023-09-30', 672000.00, 'unit', 3),
('2023-12-31', 688000.00, 'unit', 3),
('2024-03-31', 702000.00, 'unit', 3),
('2024-06-30', 718000.00, 'unit', 3),
('2024-09-30', 732000.00, 'unit', 3),
('2024-12-31', 748000.00, 'unit', 3);

-- 데이터 확인
SELECT type, bedrooms, COUNT(*) as count, MIN(saledate) as start_date, MAX(saledate) as end_date
FROM house_sales
GROUP BY type, bedrooms
ORDER BY type, bedrooms;
